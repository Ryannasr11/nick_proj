<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600">
    <!-- Background -->
    <rect width="800" height="600" fill="#f8f9fa" />
    
    <!-- Title -->
    <text x="400" y="40" font-family="Arial" font-size="24" text-anchor="middle" fill="#333">DE.ai Microservice Architecture</text>
    
    <!-- User -->
    <circle cx="100" cy="120" r="30" fill="#e1f5fe" stroke="#0288d1" stroke-width="2" />
    <text x="100" y="125" font-family="Arial" font-size="12" text-anchor="middle" fill="#333">User</text>
    
    <!-- Web UI -->
    <rect x="200" y="90" width="120" height="60" rx="5" fill="#bbdefb" stroke="#1976d2" stroke-width="2" />
    <text x="260" y="125" font-family="Arial" font-size="12" text-anchor="middle" fill="#333">Web UI</text>
    <text x="260" y="140" font-family="Arial" font-size="10" text-anchor="middle" fill="#333">Consent Management</text>
    
    <!-- API Gateway -->
    <rect x="200" y="180" width="120" height="60" rx="5" fill="#c8e6c9" stroke="#388e3c" stroke-width="2" />
    <text x="260" y="215" font-family="Arial" font-size="12" text-anchor="middle" fill="#333">API Gateway</text>
    <text x="260" y="230" font-family="Arial" font-size="10" text-anchor="middle" fill="#333">Input Validation</text>
    
    <!-- Consent Service -->
    <rect x="400" y="90" width="120" height="60" rx="5" fill="#ffecb3" stroke="#ffa000" stroke-width="2" />
    <text x="460" y="125" font-family="Arial" font-size="12" text-anchor="middle" fill="#333">Consent Service</text>
    <text x="460" y="140" font-family="Arial" font-size="10" text-anchor="middle" fill="#333">Opt-in/Opt-out</text>
    
    <!-- PII Detection & Anonymization -->
    <rect x="400" y="180" width="120" height="60" rx="5" fill="#e1bee7" stroke="#7b1fa2" stroke-width="2" />
    <text x="460" y="210" font-family="Arial" font-size="12" text-anchor="middle" fill="#333">PII Detection &</text>
    <text x="460" y="225" font-family="Arial" font-size="12" text-anchor="middle" fill="#333">Anonymization</text>
    
    <!-- Bias Check -->
    <rect x="400" y="270" width="120" height="60" rx="5" fill="#ffcdd2" stroke="#d32f2f" stroke-width="2" />
    <text x="460" y="305" font-family="Arial" font-size="12" text-anchor="middle" fill="#333">Bias Check</text>
    <text x="460" y="320" font-family="Arial" font-size="10" text-anchor="middle" fill="#333">Fairness Analysis</text>
    
    <!-- Blockchain Logger -->
    <rect x="600" y="180" width="120" height="60" rx="5" fill="#b3e5fc" stroke="#0288d1" stroke-width="2" />
    <text x="660" y="215" font-family="Arial" font-size="12" text-anchor="middle" fill="#333">Blockchain Logger</text>
    <text x="660" y="230" font-family="Arial" font-size="10" text-anchor="middle" fill="#333">Immutable Audit Trail</text>
    
    <!-- Secure Storage -->
    <rect x="600" y="270" width="120" height="60" rx="5" fill="#dcedc8" stroke="#689f38" stroke-width="2" />
    <text x="660" y="305" font-family="Arial" font-size="12" text-anchor="middle" fill="#333">Secure Storage</text>
    <text x="660" y="320" font-family="Arial" font-size="10" text-anchor="middle" fill="#333">Encrypted Data</text>
    
    <!-- Federated Extension -->
    <rect x="400" y="380" width="300" height="100" rx="5" fill="#d1c4e9" stroke="#512da8" stroke-width="2" stroke-dasharray="5,5" />
    <text x="550" y="410" font-family="Arial" font-size="14" text-anchor="middle" fill="#333">Federated Extension</text>
    
    <!-- Federated Components -->
    <rect x="420" y="430" width="80" height="40" rx="5" fill="#b39ddb" stroke="#512da8" stroke-width="1" />
    <text x="460" y="455" font-family="Arial" font-size="10" text-anchor="middle" fill="#333">Secure MPC</text>
    
    <rect x="510" y="430" width="80" height="40" rx="5" fill="#b39ddb" stroke="#512da8" stroke-width="1" />
    <text x="550" y="455" font-family="Arial" font-size="10" text-anchor="middle" fill="#333">Homomorphic</text>
    <text x="550" y="465" font-family="Arial" font-size="10" text-anchor="middle" fill="#333">Encryption</text>
    
    <rect x="600" y="430" width="80" height="40" rx="5" fill="#b39ddb" stroke="#512da8" stroke-width="1" />
    <text x="640" y="455" font-family="Arial" font-size="10" text-anchor="middle" fill="#333">Edge Computing</text>
    
    <!-- Flow Lines -->
    <!-- User to Web UI -->
    <line x1="130" y1="120" x2="200" y2="120" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)" />
    
    <!-- User to API Gateway -->
    <line x1="100" y1="150" x2="100" y2="210" stroke="#666" stroke-width="2" />
    <line x1="100" y1="210" x2="200" y2="210" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)" />
    
    <!-- Web UI to Consent Service -->
    <line x1="320" y1="120" x2="400" y2="120" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)" />
    
    <!-- API Gateway to Consent Service -->
    <line x1="260" y1="180" x2="260" y2="150" stroke="#666" stroke-width="2" />
    <line x1="260" y1="150" x2="400" y2="150" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)" />
    
    <!-- API Gateway to PII Detection -->
    <line x1="320" y1="210" x2="400" y2="210" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)" />
    
    <!-- PII Detection to Bias Check -->
    <line x1="460" y1="240" x2="460" y2="270" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)" />
    
    <!-- PII Detection to Blockchain Logger -->
    <line x1="520" y1="210" x2="600" y2="210" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)" />
    
    <!-- Bias Check to Blockchain Logger -->
    <line x1="520" y1="300" x2="560" y2="300" stroke="#666" stroke-width="2" />
    <line x1="560" y1="300" x2="560" y2="240" stroke="#666" stroke-width="2" />
    <line x1="560" y1="240" x2="600" y2="240" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)" />
    
    <!-- Bias Check to Secure Storage -->
    <line x1="520" y1="300" x2="600" y2="300" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)" />
    
    <!-- Legend -->
    <rect x="50" y="500" width="700" height="60" rx="5" fill="white" stroke="#ddd" stroke-width="1" />
    <text x="400" y="520" font-family="Arial" font-size="14" text-anchor="middle" fill="#333">Security & Privacy Features</text>
    
    <circle cx="100" cy="540" r="6" fill="#c8e6c9" />
    <text x="110" y="544" font-family="Arial" font-size="12" text-anchor="start" fill="#333">TLS/SSL</text>
    
    <circle cx="200" cy="540" r="6" fill="#ffecb3" />
    <text x="210" y="544" font-family="Arial" font-size="12" text-anchor="start" fill="#333">JWT Auth</text>
    
    <circle cx="300" cy="540" r="6" fill="#e1bee7" />
    <text x="310" y="544" font-family="Arial" font-size="12" text-anchor="start" fill="#333">Field Encryption</text>
    
    <circle cx="450" cy="540" r="6" fill="#b3e5fc" />
    <text x="460" y="544" font-family="Arial" font-size="12" text-anchor="start" fill="#333">Tokenization</text>
    
    <circle cx="600" cy="540" r="6" fill="#ffcdd2" />
    <text x="610" y="544" font-family="Arial" font-size="12" text-anchor="start" fill="#333">Zero-knowledge Proofs</text>
    
    <!-- Arrow Definitions -->
    <defs>
      <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
        <polygon points="0 0, 10 3.5, 0 7" fill="#666" />
      </marker>
    </defs>
  </svg>